document.addEventListener("DOMContentLoaded",function(){const h=document.querySelectorAll(".page-item-tag"),k=document.querySelectorAll(".clickable-filter-tag"),E=document.querySelectorAll(".page-item");function b(){const e=new URL(window.location.href).searchParams.get("tags");return e?e.split(",").filter(s=>s.trim()):[]}function v(t){const e=new URL(window.location.href);t.length>0?e.searchParams.set("tags",t.join(",")):e.searchParams.delete("tags"),window.history.pushState({},"",e.toString())}function u(t){E.forEach(e=>{const s=e.getAttribute("data-tags"),d=s?s.split(",").map(n=>n.trim()):[];if(t.length===0)e.style.display="";else{const n=t.every(l=>d.includes(l));e.style.display=n?"":"none"}})}function p(t){h.forEach(e=>{const s=e.getAttribute("data-tag");t.includes(s)?e.style.backgroundColor="#3CB371":e.style.backgroundColor="#1a4d2e"}),k.forEach(e=>{const s=e.getAttribute("data-tag");t.includes(s)?e.style.backgroundColor="#3CB371":e.style.backgroundColor="#1a4d2e"})}function f(t){const e=document.getElementById("place-description-section");if(!e)return;const s=JSON.parse(e.dataset.placeDescriptions||"{}"),d=t.filter(l=>l in s),n=d.length===1?s[d[0]]:null;if(n){document.getElementById("place-description-title").innerHTML=`${n.title}<span class="color-pink ml-1"><b>.</b></span>`,document.getElementById("place-description-text").textContent=n.description;const l=document.getElementById("place-description-links");if(n.links&&n.links.length>0)if(l)l.innerHTML=n.links.map(i=>`<a href="${i.link}" class="page-item-link text-logoDarkGreen underline">${i.text}</a>`).join(""),l.style.display="flex";else{const i=document.createElement("div");i.id="place-description-links",i.className="flex flex-wrap gap-4 mt-4";const c=document.getElementById("place-description-photos");c?e.insertBefore(i,c):e.appendChild(i),i.innerHTML=n.links.map(a=>`<a href="${a.link}" class="page-item-link text-logoDarkGreen underline">${a.text}</a>`).join(""),i.style.display="flex"}else l&&(l.style.display="none",l.innerHTML="");const o=document.getElementById("place-description-photos"),r=Array.isArray(n.photos)?n.photos:[];if(r.length>0)if(o)o.innerHTML=r.map(i=>{const c=typeof i=="string"?i:i.src,a=typeof i=="string"?n.title:i.alt;return`<img src="${c}" alt="${a}" class="rounded-xl max-w-md h-auto object-cover" loading="lazy" />`}).join(""),o.style.display="flex";else{const i=document.createElement("div");i.id="place-description-photos",i.className="flex justify-center flex-wrap gap-4 mt-6",e.appendChild(i),i.innerHTML=r.map(c=>{const a=typeof c=="string"?c:c.src,T=typeof c=="string"?n.title:c.alt;return`<img src="${a}" alt="${T}" class="rounded-xl max-w-md h-auto object-cover" loading="lazy" />`}).join(""),i.style.display="flex"}else o&&(o.style.display="none",o.innerHTML="");e.classList.remove("hidden")}else e.classList.add("hidden")}function m(t){const e=document.getElementById("distance-filters-section");if(!e)return;if(["biking","hiking","paddling","climbing"].some(n=>t.includes(n))){const n=["1-to-2-miles","3-to-5-miles","5-to-10-miles","10-to-20-miles","20-plus-miles"],l=new Set;if(E.forEach(o=>{const r=o.getAttribute("data-tags");if(!r)return;const i=r.split(",").map(a=>a.trim()),c=t.filter(a=>!n.includes(a));(c.length===0||c.every(a=>i.includes(a)))&&i.forEach(a=>{n.includes(a)&&l.add(a)})}),l.size===0){e.style.display="none";return}e.style.display="",e.querySelectorAll(".clickable-filter-tag").forEach(o=>{const r=o.getAttribute("data-tag");l.has(r)?o.style.display="":o.style.display="none"})}else e.style.display="none"}function L(t){let e=b();const s=["biking","hiking","paddling","climbing"],d=["1-to-2-miles","3-to-5-miles","5-to-10-miles","10-to-20-miles","20-plus-miles"];e.includes(t)?(e=e.filter(l=>l!==t),s.includes(t)&&(e=e.filter(l=>!d.includes(l)))):e.push(t),v(e),u(e),p(e),m(e),f(e);const n=document.getElementById("page-items-clear-filters");n&&(e.length>0?n.classList.remove("hidden"):n.classList.add("hidden"))}const g=b();g.length>0&&(p(g),u(g)),m(g),f(g),h.forEach(t=>{t.addEventListener("click",function(e){e.preventDefault();const s=this.getAttribute("data-tag");L(s)})}),k.forEach(t=>{t.addEventListener("click",function(e){e.preventDefault();const s=this.getAttribute("data-tag");L(s)})});const y=document.getElementById("page-items-clear-filters");y&&y.addEventListener("click",function(t){t.preventDefault(),v([]),u([]),p([]),m([]),f([]),y.classList.add("hidden")})});
