<!DOCTYPE html><html lang="en"> <head><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2K6JP8M5XE"></script>  <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <link rel="sitemap" href="/sitemap.xml"> <link rel="icon" type="image/x-icon" href="/images/favicon.ico">  <meta name="description" content="learn how to get the execution line when using class_eval"> <meta property="og:type" content="website"> <meta property="og:url" content="https://tinytechtuts.com"> <meta property="og:title" content="class_eval with execution lines"> <meta property="og:description" content="learn how to get the execution line when using class_eval"> <meta property="og:image" content="/images/social.jpg"> <meta property="twitter:card" content="summary_large_image"> <meta property="twitter:url" content="https://tinytechtuts.com"> <meta property="twitter:title" content="class_eval with execution lines"> <meta property="twitter:description" content="learn how to get the execution line when using class_eval"> <meta property="twitter:image" content="/images/social.jpg"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-tomorrow.min.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/toolbar/prism-toolbar.min.css"> <link href="https://fonts.googleapis.com/css2?family=Londrina+Solid:wght@900&family=Poppins:ital,wght@0,400;0,600;1,400;1,700&display=swap" rel="stylesheet"> <title>class_eval with execution lines</title><style>pre[data-astro-cid-xj2uyz6m]{padding:8px 16px;overflow:auto;border-radius:4px;background:#343434}code[data-astro-cid-xj2uyz6m]{padding:4px;border-radius:4px;background:#343434;font-family:Consolas,Monaco,Andale Mono,monospace;direction:ltr;font-size:14px}pre[data-astro-cid-xj2uyz6m]>code[data-astro-cid-xj2uyz6m]{padding:0;line-height:1.5;word-break:normal;white-space:pre;word-spacing:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4}
</style>
<link rel="stylesheet" href="/_astro/2020-add-sitemap-to-phoenix-elixir-project.A85XpehK.css" /><script type="module" src="/_astro/hoisted.tlrkCr7x.js"></script></head> <body> <nav> <div class="max-w-5xl mx-auto px-3 py-3 flex items-center justify-between h-16"> <a href="/" class="font-bold text-xl hover:text-hot-pink">TinyTechTuts</a> <a href="/search" class=""> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path> </svg> </a> </div> <div class="w-full border-b-2 border-black squiggle"></div> </nav> <main class="py-12 lg:py-20"> <article class="max-w-5xl mx-auto px-3" data-astro-cid-xj2uyz6m> <header style="margin: 0 !important" class="mx-auto max-w-3xl text-center content" data-astro-cid-xj2uyz6m> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2976969447542443" crossorigin="anonymous"></script> <meta name="google-adsense-account" content="ca-pub-2976969447542443"> <h1 data-astro-cid-xj2uyz6m>class_eval with execution lines</h1> </header> <!-- Image -->  <!-- YouTube Video -->  <!-- Content --> <section style="margin: 0 !important" class="max-w-3xl mx-auto py-6 lg:py-12 content" data-astro-cid-xj2uyz6m>  <p>If you find yourself using Ruby’s <code>class_eval</code> method to define some functions within a multi-line string, you may have difficult troubleshooting should an error occur in one of the functions you define.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> SomeObject</span></span>
<span class="line"><span style="color:#F97583">  %</span><span style="color:#E1E4E8">w(method_name_1 method_name_2).each </span><span style="color:#F97583">do</span><span style="color:#E1E4E8"> |method|</span></span>
<span class="line"><span style="color:#E1E4E8">    class_eval </span><span style="color:#9ECBFF">&#x3C;&#x3C;-RUBY</span></span>
<span class="line"><span style="color:#F97583">      def</span><span style="color:#9ECBFF"> #{method}</span></span>
<span class="line"><span style="color:#F97583">        raise</span></span>
<span class="line"><span style="color:#F97583">      end</span></span>
<span class="line"><span style="color:#9ECBFF">    RUBY</span></span>
<span class="line"><span style="color:#F97583">  end</span></span>
<span class="line"><span style="color:#F97583">end</span></span></code></pre>
<p>In the code above I define two methods (<code>method_name_1</code>, <code>method_name_2</code>) on the <code>SomeObject</code> class using <code>class_eval</code>. Each method will raise an error. Now when that error is raised, it will be hard to debug because there will be no coherent backtrace, since we are metaprogramming in this way ruby doesn’t know where the error occurred.</p>
<p>In order to get details of where the error occurred when using <code>class_eval</code> in this manor, you will need to pass two arguments to the ruby multiline string, <code>__FILE__</code> and <code>__LINE__ + 1</code>. Now when you that error is raised you will have an accurate account of where it occurred within your program.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> SomeObject</span></span>
<span class="line"><span style="color:#F97583">  %</span><span style="color:#E1E4E8">w(method_name_1 method_name_2).each </span><span style="color:#F97583">do</span><span style="color:#E1E4E8"> |method|</span></span>
<span class="line"><span style="color:#E1E4E8">    class_eval </span><span style="color:#9ECBFF">&#x3C;&#x3C;-RUBY, </span><span style="color:#79B8FF">__FILE__</span><span style="color:#9ECBFF">, </span><span style="color:#79B8FF">__LINE__</span><span style="color:#F97583"> +</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#F97583">      def</span><span style="color:#9ECBFF"> #{method}</span></span>
<span class="line"><span style="color:#F97583">        raise</span></span>
<span class="line"><span style="color:#F97583">      end</span></span>
<span class="line"><span style="color:#9ECBFF">    RUBY</span></span>
<span class="line"><span style="color:#F97583">  end</span></span>
<span class="line"><span style="color:#F97583">end</span></span></code></pre>
<p>Ruby dooby doo, says Scooby at a ruby conference. If you want to make Scoob happy, check out this post <a href="https://tinytechtuts.com/2022-convert-nested-array-to-hash/">Convert nested array to hash in Ruby</a>.</p>  </section> <div data-astro-cid-xj2uyz6m> <!-- sidebar vertical --> <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2976969447542443" crossorigin="anonymous"></script> <ins class="adsbygoogle" style="position: absolute; right: 50px; top: 200px; width: 300px; height: 1000px;" data-ad-client="ca-pub-2976969447542443" data-ad-slot="1095168865" data-ad-format="auto" data-full-width-responsive="true" data-astro-cid-xj2uyz6m></ins>  </div> </article>  </main> </body></html>