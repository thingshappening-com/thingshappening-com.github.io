<!DOCTYPE html><html lang="en"> <head><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2K6JP8M5XE"></script>  <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <link rel="sitemap" href="/sitemap.xml"> <link rel="icon" type="image/x-icon" href="/images/favicon.ico">  <meta name="description" content="cheatsheet for Ruby http gem"> <meta property="og:type" content="website"> <meta property="og:url" content="https://thingshappening.com"> <meta property="og:title" content="Ruby http gem cheatsheet"> <meta property="og:description" content="cheatsheet for Ruby http gem"> <meta property="og:image" content="/images/social.jpg"> <meta property="twitter:card" content="summary_large_image"> <meta property="twitter:url" content="https://thingshappening.com"> <meta property="twitter:title" content="Ruby http gem cheatsheet"> <meta property="twitter:description" content="cheatsheet for Ruby http gem"> <meta property="twitter:image" content="/images/social.jpg"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-tomorrow.min.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/toolbar/prism-toolbar.min.css"> <link href="https://fonts.googleapis.com/css2?family=Londrina+Solid:wght@900&family=Poppins:ital,wght@0,400;0,600;1,400;1,700&display=swap" rel="stylesheet"> <title>Ruby http gem cheatsheet</title><style>pre[data-astro-cid-xj2uyz6m]{padding:8px 16px;overflow:auto;border-radius:4px;background:#343434}code[data-astro-cid-xj2uyz6m]{padding:4px;border-radius:4px;background:#343434;font-family:Consolas,Monaco,Andale Mono,monospace;direction:ltr;font-size:14px}pre[data-astro-cid-xj2uyz6m]>code[data-astro-cid-xj2uyz6m]{padding:0;line-height:1.5;word-break:normal;white-space:pre;word-spacing:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4}
</style>
<link rel="stylesheet" href="/_astro/2020-add-sitemap-to-phoenix-elixir-project.A85XpehK.css" /><script type="module" src="/_astro/hoisted.tlrkCr7x.js"></script></head> <body> <nav> <div class="max-w-5xl mx-auto px-3 py-3 flex items-center justify-between h-16"> <a href="/" class="font-bold text-xl hover:text-hot-pink">thingshappening</a> <a href="/search" class=""> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path> </svg> </a> </div> <div class="w-full border-b-2 border-black squiggle"></div> </nav> <main class="py-12 lg:py-20"> <article class="max-w-5xl mx-auto px-3" data-astro-cid-xj2uyz6m> <header style="margin: 0 !important" class="mx-auto max-w-3xl text-center content" data-astro-cid-xj2uyz6m> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2976969447542443" crossorigin="anonymous"></script> <meta name="google-adsense-account" content="ca-pub-2976969447542443"> <h1 data-astro-cid-xj2uyz6m>Ruby http gem cheatsheet</h1> </header> <!-- Image -->  <!-- YouTube Video -->  <!-- Content --> <section style="margin: 0 !important" class="max-w-3xl mx-auto py-6 lg:py-12 content" data-astro-cid-xj2uyz6m>  <p>A few notes to refer to when needing to use the ruby http gem.</p>
<p>*This is not a comprehensive post. It is a quick reference if you have some experience with ruby/http but havenâ€™t used it recently.</p>
<ol>
<li>Updating headers</li>
</ol>
<p>Say you have your http client defined within a method like this:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>def http</span></span>
<span class="line"><span>  HTTP[</span></span>
<span class="line"><span>    authorization: "Bearer sometoken",</span></span>
<span class="line"><span>    accept: "application/json",</span></span>
<span class="line"><span>    content_type: "application/json"</span></span>
<span class="line"><span>  ]</span></span>
<span class="line"><span>end</span></span></code></pre>
<p>While building new functionality you realize you want to use this method, but need different headers, you can accomplish this through the <code>headers</code> method on the HTTP object like so:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_config</span></span>
<span class="line"><span style="color:#E1E4E8">  http</span></span>
<span class="line"><span style="color:#E1E4E8">  .headers(</span><span style="color:#79B8FF">accept:</span><span style="color:#9ECBFF"> "application/x-www-form-urlencoded"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">content_type:</span><span style="color:#9ECBFF"> "application/x-www-form-urlencoded"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">  .put(</span><span style="color:#9ECBFF">"https://somebaseurl/configuration"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">form:</span><span style="color:#E1E4E8"> config)</span></span>
<span class="line"><span style="color:#F97583">end</span></span></code></pre>
<ol start="2">
<li>Post JSON vs Form vs Body</li>
</ol>
<p>Depending on the <code>Content-Type</code> the server you are calling to is expecting you will need to send different post body options:</p>
<p>When the expected <code>Content-Type</code> is <code>application/json</code> use <code>json:</code>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">http.put(</span><span style="color:#9ECBFF">"https://somebaseurl/configuration"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">json:</span><span style="color:#E1E4E8"> config)</span></span></code></pre>
<p>When the expected <code>Content-Type</code> is <code>application/x-www-form-urlencoded</code> use <code>form:</code>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">http.post(</span><span style="color:#9ECBFF">"https://somebaseurl/configuration"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">form:</span><span style="color:#E1E4E8"> config)</span></span></code></pre>
<p>When the expected <code>Content-Type</code> is <code>application/xml</code> use <code>body:</code>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">http.post(</span><span style="color:#9ECBFF">"https://somebaseurl/configuration"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">body:</span><span style="color:#E1E4E8"> config)</span></span></code></pre>
<ol start="3">
<li>If some endpoints are expecting an <code>Authorization</code> header and others are not, you can just add the authorization header to the http client as exampled in the first note and if the server does not need authorization it will just ignore it.</li>
</ol>  </section> <div data-astro-cid-xj2uyz6m> <!-- sidebar vertical --> <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2976969447542443" crossorigin="anonymous"></script> <ins class="adsbygoogle" style="position: absolute; right: 50px; top: 200px; width: 300px; height: 1000px;" data-ad-client="ca-pub-2976969447542443" data-ad-slot="1095168865" data-ad-format="auto" data-full-width-responsive="true" data-astro-cid-xj2uyz6m></ins>  </div> </article>  </main> </body></html>