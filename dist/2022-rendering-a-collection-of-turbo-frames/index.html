<!DOCTYPE html><html lang="en"> <head><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2K6JP8M5XE"></script>  <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <link rel="sitemap" href="/sitemap.xml"> <link rel="icon" type="image/x-icon" href="/images/favicon.ico">  <meta name="description" content="How to render a collection of turbo frames"> <meta property="og:type" content="website"> <meta property="og:url" content="https://thingshappening.com"> <meta property="og:title" content="How to render a collection of turbo frames"> <meta property="og:description" content="How to render a collection of turbo frames"> <meta property="og:image" content="/images/social.jpg"> <meta property="twitter:card" content="summary_large_image"> <meta property="twitter:url" content="https://thingshappening.com"> <meta property="twitter:title" content="How to render a collection of turbo frames"> <meta property="twitter:description" content="How to render a collection of turbo frames"> <meta property="twitter:image" content="/images/social.jpg"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-tomorrow.min.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/toolbar/prism-toolbar.min.css"> <link href="https://fonts.googleapis.com/css2?family=Londrina+Solid:wght@900&family=Poppins:ital,wght@0,400;0,600;1,400;1,700&display=swap" rel="stylesheet"> <title>How to render a collection of turbo frames</title><style>pre[data-astro-cid-xj2uyz6m]{padding:8px 16px;overflow:auto;border-radius:4px;background:#343434}code[data-astro-cid-xj2uyz6m]{padding:4px;border-radius:4px;background:#343434;font-family:Consolas,Monaco,Andale Mono,monospace;direction:ltr;font-size:14px}pre[data-astro-cid-xj2uyz6m]>code[data-astro-cid-xj2uyz6m]{padding:0;line-height:1.5;word-break:normal;white-space:pre;word-spacing:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4}
</style>
<link rel="stylesheet" href="/_astro/2020-add-sitemap-to-phoenix-elixir-project.A85XpehK.css" /><script type="module" src="/_astro/hoisted.tlrkCr7x.js"></script></head> <body> <nav> <div class="max-w-5xl mx-auto px-3 py-3 flex items-center justify-between h-16"> <a href="/" class="font-bold text-xl hover:text-hot-pink">thingshappening</a> <a href="/search" class=""> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path> </svg> </a> </div> <div class="w-full border-b-2 border-black squiggle"></div> </nav> <main class="py-12 lg:py-20"> <article class="max-w-5xl mx-auto px-3" data-astro-cid-xj2uyz6m> <header style="margin: 0 !important" class="mx-auto max-w-3xl text-center content" data-astro-cid-xj2uyz6m> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2976969447542443" crossorigin="anonymous"></script> <meta name="google-adsense-account" content="ca-pub-2976969447542443"> <h1 data-astro-cid-xj2uyz6m>How to render a collection of turbo frames</h1> </header> <!-- Image -->  <!-- YouTube Video -->  <!-- Content --> <section style="margin: 0 !important" class="max-w-3xl mx-auto py-6 lg:py-12 content" data-astro-cid-xj2uyz6m>  <p>This is a code example of how to render a collection of Turbo Frames for inline editing within each frame. This is going to be a continuation from a previous post on <a href="https://thingshappening.com/2022-rendering-a-turbo-frame-inside-a-form/">redering Turbo Frames within a form</a>.</p>
<p>Turbo Frames work by first rendering the html content within the frame and then if you click an internal link within a turbo frame it will make a network request to get new html that will replace the current contents of the frame. For this to happen a Turbo Frame with the same Turbo Frame ID needs to exist on both sides of the frame, later in this example that will see that as <code>name_frame_id</code>.</p>
<p>To handle this we will need to add an index action to the <code>OrdersController</code> that retrieves the orders collection from the database and an <code>edit_from_step</code> action to get the html contents of the other side of the Turbo Frame.</p>
<p>orders_controller.rb</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> OrdersController</span><span style="color:#F97583"> &#x3C;</span><span style="color:#B392F0"> ApplicationController</span></span>
<span class="line"><span style="color:#F97583">  def</span><span style="color:#B392F0"> index</span></span>
<span class="line"><span style="color:#E1E4E8">    @orders </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> Order</span><span style="color:#E1E4E8">.all</span></span>
<span class="line"><span style="color:#F97583">  end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  def</span><span style="color:#B392F0"> edit_from_step</span></span>
<span class="line"><span style="color:#E1E4E8">    @order </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> @order</span></span>
<span class="line"><span style="color:#E1E4E8">    @step </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> params[</span><span style="color:#79B8FF">:step_id</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    render </span><span style="color:#79B8FF">:edit</span></span>
<span class="line"><span style="color:#F97583">  end</span></span>
<span class="line"><span style="color:#F97583">end</span></span></code></pre>
<p>And then in the html template we will iterate over the list of orders and render a Turbo Frame partial for each order. In the partial there is a link to the <code>edit_from_step</code> path, which when clicked will execute an async request to get the html returned from that request and replace our current from contents with the new frame contents. So in this example the contents of the frame in <code>_order.html.erb</code> will be replaced with matching turbo frame contents of <code>_step_(step_id).html.erb</code>.</p>
<p>In this example the html at <code>_step_(step_id).html.erb</code> contains a form within the frame to edit the contents previously displayed by the frame before clicking the link, which can be used for inline editing.</p>
<p>index.html.erb</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">&#x3C;</span><span style="color:#E1E4E8">div id</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"orders"</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;%</span><span style="color:#E1E4E8"> @orders.each_with_index </span><span style="color:#F97583">do</span><span style="color:#E1E4E8"> |order, index| </span><span style="color:#9ECBFF">%></span></span>
<span class="line"><span style="color:#9ECBFF">    &#x3C;%= render partial: "order", locals: { index: index, order: order }  %></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;%</span><span style="color:#F97583"> end</span><span style="color:#9ECBFF"> %></span></span>
<span class="line"><span style="color:#9ECBFF">&#x3C;/div></span></span></code></pre>
<p>_order.html.erb</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">&#x3C;%</span><span style="color:#E1E4E8"> name_frame_id </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dom_id(order, </span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">) </span><span style="color:#9ECBFF">%></span></span>
<span class="line"><span style="color:#9ECBFF">&#x3C;%= turbo_frame_tag name_frame_id, data: { turbo_frame: name_frame_id } do %></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;</span><span style="color:#E1E4E8">h3</span><span style="color:#F97583">></span><span style="color:#79B8FF">NAME</span><span style="color:#F97583">&#x3C;/</span><span style="color:#E1E4E8">h3</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;</span><span style="color:#E1E4E8">div></span><span style="color:#F97583">&#x3C;%=</span><span style="color:#E1E4E8"> order.name </span><span style="color:#9ECBFF">%>&#x3C;/div></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;%=</span><span style="color:#E1E4E8"> link_to </span><span style="color:#9ECBFF">"Edit Name"</span><span style="color:#E1E4E8">, edit_from_step_path(order, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">) </span><span style="color:#9ECBFF">%></span></span>
<span class="line"><span style="color:#9ECBFF">  &#x3C;br/></span></span>
<span class="line"><span style="color:#F97583">&#x3C;%</span><span style="color:#F97583"> end</span><span style="color:#9ECBFF"> %></span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">&#x3C;% toppings_frame_id = dom_id(order, "toppings") %></span></span>
<span class="line"><span style="color:#F97583">&#x3C;%=</span><span style="color:#E1E4E8"> turbo_frame_tag toppings_frame_id, </span><span style="color:#79B8FF">data:</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">turbo_frame:</span><span style="color:#E1E4E8"> toppings_frame_id } </span><span style="color:#F97583">do</span><span style="color:#9ECBFF"> %></span></span>
<span class="line"><span style="color:#9ECBFF">  &#x3C;h3></span><span style="color:#79B8FF">TOPPINGS</span><span style="color:#F97583">&#x3C;/</span><span style="color:#E1E4E8">h3</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;%</span><span style="color:#E1E4E8"> order.toppings.each </span><span style="color:#F97583">do</span><span style="color:#E1E4E8"> |topping| </span><span style="color:#9ECBFF">%></span></span>
<span class="line"><span style="color:#9ECBFF">    &#x3C;p></span><span style="color:#F97583">&#x3C;%=</span><span style="color:#E1E4E8"> topping </span><span style="color:#9ECBFF">%>&#x3C;/p></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;%</span><span style="color:#F97583"> end</span><span style="color:#9ECBFF"> %></span></span>
<span class="line"><span style="color:#9ECBFF">  &#x3C;%= link_to "Edit Toppings", edit_from_step_path(order, 2) %></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;</span><span style="color:#E1E4E8">br </span><span style="color:#F97583">/></span></span>
<span class="line"><span style="color:#F97583">&#x3C;%</span><span style="color:#F97583"> end</span><span style="color:#9ECBFF"> %></span></span></code></pre>
<p>edit.html.erb</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">&#x3C;%=</span><span style="color:#E1E4E8"> render </span><span style="color:#79B8FF">partial:</span><span style="color:#9ECBFF"> "orders/separate_form_partials/_step_</span><span style="color:#9ECBFF">#{</span><span style="color:#E1E4E8">@step</span><span style="color:#F97583"> ?</span><span style="color:#E1E4E8"> @step</span><span style="color:#9ECBFF"> : order.step}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">locals:</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">order:</span><span style="color:#E1E4E8"> @order } </span><span style="color:#9ECBFF">%></span></span></code></pre>
<p>orders/separate_form_partials/_step_1.html.erb</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">&#x3C;</span><span style="color:#E1E4E8">h1</span><span style="color:#F97583">></span><span style="color:#79B8FF">Name</span><span style="color:#F97583">&#x3C;/</span><span style="color:#E1E4E8">h1</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#F97583">&#x3C;%</span><span style="color:#E1E4E8"> name_frame_id </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dom_id(order, </span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">) </span><span style="color:#9ECBFF">%></span></span>
<span class="line"><span style="color:#9ECBFF">&#x3C;%= turbo_frame_tag name_frame_id, data: { turbo_frame: name_frame_id } do %></span></span>
<span class="line"><span style="color:#F97583">  &#x3C;%=</span><span style="color:#E1E4E8"> form_with(</span><span style="color:#79B8FF">model:</span><span style="color:#E1E4E8"> order) </span><span style="color:#F97583">do</span><span style="color:#E1E4E8"> |form| </span><span style="color:#9ECBFF">%></span></span>
<span class="line"><span style="color:#9ECBFF">    &#x3C;% if order.errors.any? %></span></span>
<span class="line"><span style="color:#F97583">      &#x3C;</span><span style="color:#E1E4E8">div style</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"color: red"</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#F97583">        &#x3C;</span><span style="color:#E1E4E8">h2></span><span style="color:#F97583">&#x3C;%=</span><span style="color:#E1E4E8"> pluralize(order.errors.count, </span><span style="color:#9ECBFF">"error"</span><span style="color:#E1E4E8">) </span><span style="color:#9ECBFF">%> prohibited this order from being saved:&#x3C;/h2></span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        &#x3C;</span><span style="color:#E1E4E8">ul</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#F97583">          &#x3C;%</span><span style="color:#E1E4E8"> order.errors.each </span><span style="color:#F97583">do</span><span style="color:#E1E4E8"> |error| </span><span style="color:#9ECBFF">%></span></span>
<span class="line"><span style="color:#9ECBFF">            &#x3C;li></span><span style="color:#F97583">&#x3C;%=</span><span style="color:#E1E4E8"> error.full_message </span><span style="color:#9ECBFF">%>&#x3C;/li></span></span>
<span class="line"><span style="color:#F97583">          &#x3C;%</span><span style="color:#F97583"> end</span><span style="color:#9ECBFF"> %></span></span>
<span class="line"><span style="color:#9ECBFF">        &#x3C;/ul></span></span>
<span class="line"><span style="color:#F97583">      &#x3C;/</span><span style="color:#E1E4E8">div</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#F97583">    &#x3C;%</span><span style="color:#F97583"> end</span><span style="color:#9ECBFF"> %></span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    &#x3C;%= form.text_field :name %></span></span>
<span class="line"><span style="color:#F97583">    &#x3C;%=</span><span style="color:#E1E4E8"> form.submit </span><span style="color:#9ECBFF">"Continue Order"</span><span style="color:#9ECBFF"> %></span></span>
<span class="line"><span style="color:#9ECBFF">  &#x3C;% end %></span></span>
<span class="line"><span style="color:#F97583">&#x3C;%</span><span style="color:#F97583"> end</span><span style="color:#9ECBFF"> %></span></span></code></pre>  </section> <div data-astro-cid-xj2uyz6m> <!-- sidebar vertical --> <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2976969447542443" crossorigin="anonymous"></script> <ins class="adsbygoogle" style="position: absolute; right: 50px; top: 200px; width: 300px; height: 1000px;" data-ad-client="ca-pub-2976969447542443" data-ad-slot="1095168865" data-ad-format="auto" data-full-width-responsive="true" data-astro-cid-xj2uyz6m></ins>  </div> </article>  </main> </body></html>